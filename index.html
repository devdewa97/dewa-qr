<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>DewaQR | Premium Identity Authentication & Verification</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800;900&family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-deep: #020617;
            --bg-card: #0f172a;
            --accent: #fbbf24;
            --font-head: 'Montserrat', sans-serif;
            --font-body: 'Plus Jakarta Sans', sans-serif;
        }
        
        body { 
            font-family: var(--font-body); 
            scroll-behavior: smooth; 
            background-color: var(--bg-deep);
            color: #f1f5f9;
            line-height: 1.6;
        }

        h1, h2, h3, h4, .font-heading { font-family: var(--font-head); letter-spacing: -0.02em; }
        .standard-rounded { border-radius: 10px !important; }

        /* Animated Gradient Background */
        .animated-bg {
            background: linear-gradient(-45deg, #020617, #0f172a, #1e1b4b, #020617);
            background-size: 400% 400%;
            animation: gradient-flow 15s ease infinite;
        }

        @keyframes gradient-flow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.75);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .btn-premium {
            background: linear-gradient(90deg, #fbbf24, #f59e0b, #fbbf24);
            background-size: 200% auto;
            transition: 0.5s;
            animation: shine 3s linear infinite;
        }
        @keyframes shine { to { background-position: 200% center; } }

        #verification-page { display: none; }

        /* Mobile Optimization: Disable Auto-Zoom */
        input, textarea, select { font-size: 16px !important; border-radius: 10px !important; }

        .tab-btn.active-tab {
            background: #fbbf24;
            color: #020617;
            font-weight: 800;
            border-color: #fbbf24;
        }

        .custom-scrollbar::-webkit-scrollbar { height: 5px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        
        .verified-pulse { animation: pulse-green 2s infinite; }
        @keyframes pulse-green {
            0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.3); }
            70% { box-shadow: 0 0 0 20px rgba(34, 197, 94, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- NAVIGATION BAR -->
    <nav id="main-nav" class="fixed top-0 w-full z-50 glass-panel border-b border-white/5">
        <div class="max-w-7xl mx-auto px-6 h-16 md:h-20 flex items-center justify-between">
            <div class="flex items-center gap-3 cursor-pointer" onclick="window.location.href=window.location.origin+window.location.pathname">
                <div class="w-9 h-9 bg-amber-500 flex items-center justify-center font-black text-slate-950 text-xl standard-rounded shadow-[0_0_15px_rgba(251,191,36,0.6)]">D</div>
                <span class="text-xl md:text-2xl font-black tracking-tighter text-white font-heading uppercase">DEWA<span class="text-amber-500">QR</span></span>
            </div>
            <div class="hidden md:flex items-center gap-8 text-[10px] font-bold text-slate-400 uppercase tracking-[0.25em]">
                <a href="#features" class="hover:text-amber-400 transition-all">Features</a>
                <a href="#generator" class="hover:text-amber-400 transition-all">Generator</a>
            </div>
            <a href="#generator" class="bg-white text-slate-950 px-6 py-2 text-[11px] font-black uppercase tracking-widest hover:bg-amber-500 transition-all shadow-lg standard-rounded">Get Started</a>
        </div>
    </nav>

    <div id="main-app">
        <!-- HERO SECTION -->
        <section class="animated-bg pt-32 md:pt-52 pb-24 md:pb-44 px-6 relative text-center">
            <div class="max-w-5xl mx-auto relative z-10">
                <div class="inline-flex items-center gap-3 px-6 py-2 border border-white/10 mb-10 bg-white/5 standard-rounded shadow-2xl">
                    <span class="w-1.5 h-1.5 bg-amber-500 rounded-full animate-ping"></span>
                    <span class="text-[9px] md:text-[10px] font-bold tracking-[0.4em] uppercase text-amber-200">Official High-Integrity Protocol</span>
                </div>
                
                <h1 class="text-3xl sm:text-6xl md:text-8xl font-black tracking-tighter mb-10 leading-[1.1] text-white font-heading px-4 uppercase">
                    Advanced Digital <br class="hidden md:block"> 
                    <span class="text-amber-500">Identity Verification</span>
                </h1>
                
                <p class="text-sm md:text-xl text-slate-400 max-w-3xl mx-auto leading-relaxed mb-16 font-light px-6 opacity-90">
                    DewaQR delivers a high-integrity ecosystem for visual authentication. Generate and verify secure credentials with instantaneous global accessibility through cutting-edge technology.
                </p>
                
                <div class="flex flex-col sm:flex-row items-center justify-center gap-6">
                    <a href="#generator" class="w-full sm:w-auto btn-premium text-slate-950 font-black px-12 py-5 shadow-2xl text-xs md:text-sm uppercase tracking-widest standard-rounded active:scale-95">
                        Build Your Module Now
                    </a>
                </div>
            </div>
        </section>

        <!-- BENEFITS -->
        <section id="features" class="py-24 px-6 relative z-20">
            <div class="max-w-7xl mx-auto grid md:grid-cols-3 gap-10">
                <div class="glass-panel p-10 md:p-14 shadow-2xl standard-rounded border border-white/5 transition-all hover:border-amber-500/30">
                    <div class="w-12 h-12 bg-white/5 flex items-center justify-center text-amber-500 mb-8 standard-rounded">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>
                    </div>
                    <h3 class="text-xl font-bold mb-4 text-white uppercase tracking-tight font-heading">Secure Encryption</h3>
                    <p class="text-slate-400 text-sm leading-relaxed font-medium">All identification data is processed locally on your device to ensure maximum privacy and data sovereignty.</p>
                </div>
                <div class="glass-panel p-10 md:p-14 shadow-2xl standard-rounded border border-white/5 transition-all hover:border-amber-500/30">
                    <div class="w-12 h-12 bg-white/5 flex items-center justify-center text-amber-500 mb-8 standard-rounded">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
                    </div>
                    <h3 class="text-xl font-bold mb-4 text-white uppercase tracking-tight font-heading">HD Authentication</h3>
                    <p class="text-slate-400 text-sm leading-relaxed font-medium">Generate and verify official credentials in real-time with an elegant and high-definition visual interface.</p>
                </div>
                <div class="glass-panel p-10 md:p-14 shadow-2xl standard-rounded border border-white/5 transition-all hover:border-amber-500/30">
                    <div class="w-12 h-12 bg-white/5 flex items-center justify-center text-amber-500 mb-8 standard-rounded">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
                    </div>
                    <h3 class="text-xl font-bold mb-4 text-white uppercase tracking-tight font-heading">Premium Interface</h3>
                    <p class="text-slate-400 text-sm leading-relaxed font-medium">Professional design architecture providing a seamless experience for administrators and high-value subjects.</p>
                </div>
            </div>
        </section>

        <!-- GENERATOR PANEL -->
        <section id="generator" class="py-24 px-6 relative bg-slate-950/30">
            <div class="max-w-7xl mx-auto">
                <div class="text-center mb-16 px-4">
                    <h2 class="text-3xl md:text-5xl font-black text-white mb-6 uppercase tracking-tighter font-heading text-nowrap">Identity Hub</h2>
                    <p class="text-slate-400 font-medium max-w-2xl mx-auto opacity-80">Select a specialized module to generate your authenticated QR credential certificate.</p>
                </div>

                <div class="flex overflow-x-auto custom-scrollbar gap-2 mb-12 pb-6 justify-start md:justify-center px-4">
                    <button onclick="switchTab('signature')" id="tab-signature" class="tab-btn active-tab whitespace-nowrap px-8 py-3 text-[10px] font-black uppercase tracking-widest border border-white/10 text-slate-400">Signature</button>
                    <button onclick="switchTab('vcard')" id="tab-vcard" class="tab-btn whitespace-nowrap px-8 py-3 text-[10px] font-black uppercase tracking-widest border border-white/10 text-slate-400 hover:text-white transition-all">vCard</button>
                    <button onclick="switchTab('url')" id="tab-url" class="tab-btn whitespace-nowrap px-8 py-3 text-[10px] font-black uppercase tracking-widest border border-white/10 text-slate-400 hover:text-white transition-all">Link</button>
                    <button onclick="switchTab('maps')" id="tab-maps" class="tab-btn whitespace-nowrap px-8 py-3 text-[10px] font-black uppercase tracking-widest border border-white/10 text-slate-400 hover:text-white transition-all">Maps</button>
                    <button onclick="switchTab('wa')" id="tab-wa" class="tab-btn whitespace-nowrap px-8 py-3 text-[10px] font-black uppercase tracking-widest border border-white/10 text-slate-400 hover:text-white transition-all">WA</button>
                    <button onclick="switchTab('file')" id="tab-file" class="tab-btn whitespace-nowrap px-8 py-3 text-[10px] font-black uppercase tracking-widest border border-white/10 text-slate-400 hover:text-white transition-all">File</button>
                </div>

                <div class="grid lg:grid-cols-12 gap-10 items-start text-left">
                    <div class="lg:col-span-7 glass-panel p-8 md:p-14 shadow-2xl standard-rounded">
                        <!-- Signature Form -->
                        <div id="form-signature" class="gen-form space-y-10 animate-in fade-in slide-in-from-left-4 duration-500">
                            <h4 class="text-xl md:text-2xl font-black text-white uppercase tracking-tighter font-heading flex items-center gap-3">
                                <span class="w-1.5 h-6 bg-amber-500 standard-rounded shadow-[0_0_15px_#fbbf24]"></span> Authentication Setup
                            </h4>
                            <div class="space-y-8">
                                <div class="space-y-2">
                                    <label class="block text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em]">Subject Full Name *</label>
                                    <input type="text" id="sig-name" placeholder="GUSTI DEWA ANGGADING" class="w-full px-6 py-4 bg-slate-900/80 border border-white/10 focus:border-amber-500 outline-none text-white transition-all font-bold uppercase tracking-wide">
                                </div>
                                <div class="grid md:grid-cols-2 gap-8">
                                    <div class="space-y-2">
                                        <label class="block text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em]">Issuing Entity *</label>
                                        <input type="text" id="sig-org" placeholder="PT DIGILABS KREASI NUSA" class="w-full px-6 py-4 bg-slate-900/80 border border-white/10 focus:border-amber-500 outline-none text-white transition-all font-bold uppercase">
                                    </div>
                                    <div class="space-y-2">
                                        <label class="block text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em]">Designation</label>
                                        <input type="text" id="sig-role" placeholder="OWNER" class="w-full px-6 py-4 bg-slate-900/80 border border-white/10 focus:border-amber-500 outline-none text-white transition-all font-bold uppercase">
                                    </div>
                                </div>
                            </div>
                            <div class="bg-white/5 p-8 border-2 border-dashed border-white/10 standard-rounded text-center group hover:border-amber-500/50 transition-all">
                                <label class="block text-[10px] font-bold text-amber-500 mb-4 uppercase tracking-widest">Upload Digital Signature (Original Specimen)</label>
                                <input type="file" id="sig-img-upload" accept="image/*" class="w-full text-[11px] font-bold text-slate-500 cursor-pointer file:bg-amber-500 file:border-0 file:px-6 file:py-2 file:text-slate-950 file:rounded-md file:mr-4 file:font-black file:uppercase">
                            </div>
                            <button onclick="generateSignatureQR()" class="w-full btn-premium text-slate-950 font-black py-5 shadow-2xl uppercase tracking-widest text-xs standard-rounded">
                                Generate Authenticated QR
                            </button>
                        </div>

                        <!-- Extra Modules -->
                        <div id="form-vcard" class="gen-form hidden space-y-6 animate-in fade-in duration-300">
                            <h4 class="text-2xl font-black text-white uppercase tracking-tighter font-heading">Digital vCard</h4>
                            <div class="grid grid-cols-2 gap-4">
                                <input type="text" id="vc-fn" placeholder="First Name" class="w-full px-5 py-4 bg-slate-900/80 border border-white/10 text-white outline-none focus:border-amber-500 font-bold uppercase">
                                <input type="text" id="vc-ln" placeholder="Last Name" class="w-full px-5 py-4 bg-slate-900/80 border border-white/10 text-white outline-none focus:border-amber-500 font-bold uppercase">
                            </div>
                            <input type="tel" id="vc-tel" placeholder="Mobile Number" class="w-full px-5 py-4 bg-slate-900/80 border border-white/10 text-white outline-none focus:border-amber-500 font-bold uppercase">
                            <button onclick="generateBasicQR('vcard')" class="w-full btn-premium text-slate-950 font-black py-4 uppercase text-xs tracking-widest">Generate vCard</button>
                        </div>
                        <div id="form-url" class="gen-form hidden space-y-4 animate-in fade-in duration-300">
                            <h4 class="text-2xl font-black text-white uppercase font-heading">URL Redirection</h4>
                            <input type="url" id="url-input" placeholder="https://corporate-domain.com" class="w-full px-5 py-4 bg-slate-900/80 border border-white/10 text-white outline-none font-bold">
                            <button onclick="generateBasicQR('url')" class="w-full btn-premium text-slate-950 font-black py-4 uppercase text-xs tracking-widest">Generate Web Link</button>
                        </div>
                        <div id="form-maps" class="gen-form hidden space-y-4 animate-in fade-in duration-300">
                            <h4 class="text-2xl font-black text-white uppercase font-heading">Location Link</h4>
                            <input type="url" id="map-url" placeholder="Google Maps Share Link" class="w-full px-5 py-4 bg-slate-900/80 border border-white/10 text-white outline-none font-bold">
                            <button onclick="generateBasicQR('maps')" class="w-full btn-premium text-slate-950 font-black py-4 uppercase text-xs tracking-widest">Generate Maps</button>
                        </div>
                        <div id="form-wa" class="gen-form hidden space-y-4 animate-in fade-in duration-300">
                            <h4 class="text-2xl font-black text-white uppercase font-heading">WhatsApp Direct</h4>
                            <input type="tel" id="wa-num" placeholder="628..." class="w-full px-5 py-4 bg-slate-900/80 border border-white/10 text-white outline-none font-bold">
                            <textarea id="wa-msg" rows="2" placeholder="Auto-message text..." class="w-full px-5 py-4 bg-slate-900/80 border border-white/10 text-white outline-none font-bold"></textarea>
                            <button onclick="generateBasicQR('wa')" class="w-full btn-premium text-slate-950 font-black py-4 uppercase text-xs tracking-widest">Generate WA Link</button>
                        </div>
                        <div id="form-file" class="gen-form hidden space-y-4 animate-in fade-in duration-300">
                            <h4 class="text-2xl font-black text-white uppercase font-heading">Cloud File</h4>
                            <input type="url" id="file-url" placeholder="Direct URL to PDF/Image" class="w-full px-5 py-4 bg-slate-900/80 border border-white/10 text-white outline-none font-bold">
                            <button onclick="generateBasicQR('file')" class="w-full btn-premium text-slate-950 font-black py-4 uppercase text-xs tracking-widest">Generate File Link</button>
                        </div>

                        <!-- Branding -->
                        <div class="mt-12 pt-8 border-t border-white/10 flex flex-col md:flex-row items-center gap-8">
                            <div class="flex-1 text-center md:text-left">
                                <h5 class="text-xs font-black text-white uppercase tracking-widest mb-1 font-heading">Corporate Branding</h5>
                                <p class="text-[10px] text-slate-500 font-medium leading-relaxed opacity-70">Optional: Embed institutional logo to the center of the QR module.</p>
                            </div>
                            <input type="file" id="logo-upload" accept="image/*" class="w-full md:w-auto text-[9px] font-bold text-slate-400">
                        </div>
                    </div>

                    <!-- PREVIEW AREA -->
                    <div class="lg:col-span-5 sticky top-24">
                        <div class="glass-panel p-10 md:p-14 shadow-2xl text-center flex flex-col items-center justify-center min-h-[450px] md:min-h-[550px] standard-rounded border border-white/5">
                            <div id="preview-empty" class="space-y-8 opacity-20">
                                <div class="w-24 h-24 border-4 border-amber-500 flex items-center justify-center mx-auto standard-rounded shadow-[0_0_20px_rgba(251,191,36,0.3)] text-amber-500">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><rect x="2" y="2" width="20" height="20" rx="0"/><rect x="5" y="5" width="5" height="5"/><rect x="14" y="5" width="5" height="5"/><rect x="5" y="14" width="5" height="5"/></svg>
                                </div>
                                <p class="font-black uppercase tracking-[0.6em] text-[11px] text-white">System Ready</p>
                            </div>

                            <div id="preview-result" class="hidden w-full space-y-12 animate-in zoom-in-95 duration-500">
                                <div class="bg-white p-6 shadow-[0_0_60px_rgba(255,255,255,0.1)] inline-block standard-rounded" id="qrcode-container">
                                    <div id="qrcode" class="hidden"></div>
                                    <canvas id="final-qr-canvas" class="mx-auto max-w-full h-auto standard-rounded"></canvas>
                                </div>
                                <button onclick="downloadFinalQR()" class="w-full bg-white text-slate-950 font-black py-5 shadow-2xl hover:bg-amber-500 transition-all flex items-center justify-center gap-4 active:scale-95 uppercase text-xs tracking-[0.25em] standard-rounded">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                                    Export Authenticated PNG
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- FOOTER -->
        <footer id="footer" class="bg-black pt-24 pb-12 px-6 border-t border-white/5 text-center md:text-left">
            <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-12">
                <div class="space-y-6 max-w-lg">
                    <div class="flex items-center justify-center md:justify-start gap-4">
                        <div class="w-10 h-10 bg-amber-500 flex items-center justify-center font-black text-slate-950 text-2xl standard-rounded shadow-[0_0_15px_#fbbf24]">D</div>
                        <span class="text-2xl font-black tracking-tighter uppercase text-white font-heading">DEWA<span class="text-amber-500">QR</span></span>
                    </div>
                    <p class="text-slate-500 text-sm leading-relaxed font-medium">
                        Secure digital identification infrastructure providing instantaneous visual authentication solutions. Redefining professional standards.
                    </p>
                </div>
                <div class="text-center md:text-right">
                    <p class="text-slate-400 text-sm font-extrabold uppercase tracking-widest font-heading opacity-80">© 2026 DEWAQR — Copyright by Dewa</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- VERIFICATION PAGE (HD & MINIMALIST) -->
    <div id="verification-page" class="min-h-screen bg-slate-50 flex flex-col items-center justify-center p-4 md:p-10 font-body">
        <div class="max-w-xl w-full bg-white shadow-[0_40px_120px_rgba(0,0,0,0.12)] standard-rounded overflow-hidden animate-in zoom-in-95 duration-500">
            <!-- Professional Header -->
            <div class="bg-green-50 border-b border-green-100 p-10 md:p-14 text-center relative">
                <div class="w-20 h-20 bg-green-500 flex items-center justify-center mx-auto mb-6 shadow-xl rounded-full verified-pulse">
                    <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="4"><polyline points="20 6 9 17 4 12"/></svg>
                </div>
                <h1 class="text-2xl md:text-4xl font-black uppercase text-green-700 tracking-tight font-heading leading-tight">Identity Verified</h1>
                <p class="text-xs font-bold text-green-600/70 uppercase tracking-[0.4em] mt-1">Authenticated by DewaQR</p>
            </div>

            <!-- Credentials Content Area -->
            <div class="p-8 md:p-14 space-y-12 text-slate-900 text-left">
                <!-- Formal Authenticity Statement -->
                <div class="bg-slate-50/80 p-8 standard-rounded border border-slate-100">
                    <p class="text-[11.5px] leading-relaxed text-slate-600 font-medium italic text-center">
                        "Credential Authenticity Statement: This digital record serves as a validated verification of the subject's identity. Metadata is issued through the DewaQR cryptographic authentication protocol."
                    </p>
                </div>

                <!-- Info Grid -->
                <div class="space-y-10">
                    <div class="flex items-start gap-6">
                        <div class="w-12 h-12 bg-slate-100 flex items-center justify-center rounded-lg text-slate-500 shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                        </div>
                        <div class="flex-1 overflow-hidden">
                            <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1.5">Registered Subject</p>
                            <p id="v-name" class="font-black text-2xl md:text-3xl uppercase tracking-tighter text-slate-900 leading-none font-heading">-</p>
                        </div>
                    </div>

                    <div class="flex items-start gap-6">
                        <div class="w-12 h-12 bg-slate-100 flex items-center justify-center rounded-lg text-slate-500 shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                        </div>
                        <div class="flex-1 overflow-hidden">
                            <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1.5">Affiliated Entity</p>
                            <p id="v-org" class="font-bold text-xl md:text-2xl uppercase tracking-tight text-slate-800 leading-none">-</p>
                            <p id="v-role" class="font-bold text-[11px] uppercase text-slate-500 mt-3 tracking-widest">-</p>
                        </div>
                    </div>

                    <div class="flex items-start gap-6">
                        <div class="w-12 h-12 bg-slate-100 flex items-center justify-center rounded-lg text-slate-500 shrink-0">
                            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>
                        </div>
                        <div class="flex-1">
                            <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1.5">Issuance Date</p>
                            <p id="v-date" class="font-bold text-base uppercase text-slate-800 leading-none">-</p>
                        </div>
                    </div>
                </div>

                <!-- HD Signature Section -->
                <div class="pt-10 border-t border-slate-100">
                    <div class="flex items-center justify-between mb-6">
                        <p class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Digital Specimen Spec</p>
                        <div class="h-px bg-slate-100 flex-1 ml-6"></div>
                    </div>
                    <div class="bg-slate-50 border-2 border-slate-100 p-8 flex items-center justify-center min-h-[220px] standard-rounded shadow-inner">
                        <img id="v-sig-img" src="" alt="Signature" class="max-w-full h-auto max-h-52 contrast-[2] grayscale hover:grayscale-0 transition-all duration-700 select-none">
                    </div>
                </div>

                <!-- Footer Metadata -->
                <div class="pt-8 border-t border-slate-100 flex justify-between items-center opacity-40 select-none">
                    <p id="v-code" class="font-mono text-[10px] font-bold tracking-tighter uppercase">-</p>
                    <div class="text-slate-950 font-black italic text-5xl tracking-tighter font-heading leading-none uppercase">DEWAQR</div>
                </div>
            </div>
            
            <div class="bg-slate-950 p-10 text-center">
                <button onclick="buttonBack()" class="w-full text-white font-black text-[11px] uppercase tracking-[0.3em] py-5 standard-rounded border border-white/10 hover:bg-amber-500 hover:text-slate-950 transition-all shadow-xl active:scale-95">
                    Return to Dashboard
                </button>
            </div>
        </div>
        <p class="mt-8 text-[11px] text-slate-400 font-bold uppercase tracking-[0.5em] opacity-40">System Protocol Authenticated by DewaQR</p>
    </div>

    <script>
        let uploadedSigData = "", uploadedLogoData = "";

        window.onload = () => { checkURL(); initFiles(); };

        function buttonBack() { window.location.href = window.location.origin + window.location.pathname; }

        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.className = "tab-btn whitespace-nowrap px-8 py-3 text-[10px] font-black border border-white/10 text-slate-400 uppercase tracking-widest standard-rounded transition-all";
            });
            const activeTabBtn = document.getElementById(`tab-${tab}`);
            if (activeTabBtn) { activeTabBtn.className = "tab-btn active-tab whitespace-nowrap px-8 py-3 text-[10px] font-black uppercase tracking-widest shadow-lg standard-rounded transition-all"; }

            document.querySelectorAll('.gen-form').forEach(f => f.classList.add('hidden'));
            const targetForm = document.getElementById(`form-${tab}`);
            if (targetForm) { targetForm.classList.remove('hidden'); }
        }

        function initFiles() {
            const logoInput = document.getElementById('logo-upload');
            if(logoInput) { logoInput.onchange = (e) => {
                    const reader = new FileReader();
                    reader.onload = (ev) => { uploadedLogoData = ev.target.result; };
                    reader.readAsDataURL(e.target.files[0]);
                };
            }
            const sigInput = document.getElementById('sig-img-upload');
            if(sigInput) { sigInput.onchange = (e) => {
                    const reader = new FileReader();
                    reader.onload = (ev) => { uploadedSigData = ev.target.result; };
                    reader.readAsDataURL(e.target.files[0]);
                };
            }
        }

        // Optimized Resolution: 100x50 provides HD clarity within QR data limits
        async function signatureToHDBytemap(src, w, h) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => {
                    const c = document.createElement('canvas'); c.width = w; c.height = h;
                    const cx = c.getContext('2d');
                    cx.fillStyle = "white"; cx.fillRect(0,0,w,h);
                    cx.drawImage(img, 0, 0, w, h);
                    const imageData = cx.getImageData(0, 0, w, h).data;
                    let bits = "";
                    for (let i = 0; i < imageData.length; i += 4) {
                        bits += ((imageData[i] + imageData[i+1] + imageData[i+2])/3 < 185 ? "1" : "0");
                    }
                    let hex = "";
                    for (let i = 0; i < bits.length; i += 4) hex += parseInt(bits.substr(i, 4), 2).toString(16);
                    resolve(hex);
                };
                img.src = src;
            });
        }

        function hdBytemapToImage(hex, w, h) {
            let bits = "";
            for (let i = 0; i < hex.length; i++) bits += parseInt(hex[i], 16).toString(2).padStart(4, '0');
            const c = document.createElement('canvas'); c.width = w; c.height = h;
            const cx = c.getContext('2d');
            const imgData = cx.createImageData(w, h);
            for (let i = 0; i < bits.length; i++) {
                const val = bits[i] === "1" ? 0 : 255;
                const idx = i * 4;
                imgData.data[idx] = imgData.data[idx+1] = imgData.data[idx+2] = val;
                imgData.data[idx+3] = 255;
            }
            cx.putImageData(imgData, 0, 0);
            return c.toDataURL();
        }

        async function generateSignatureQR() {
            const n = document.getElementById('sig-name').value || "GUSTI DEWA ANGGADING"; 
            const o = document.getElementById('sig-org').value || "PT DIGILABS KREASI NUSA"; 
            const r = document.getElementById('sig-role').value || "OWNER";
            if (!uploadedSigData) return alertCustom('Please upload a signature specimen!');
            
            // Reconstruct at 100x50 for safe data limits (approx 1250 hex chars)
            const hexHD = await signatureToHDBytemap(uploadedSigData, 100, 50);
            
            // Short keys for data saving
            const data = { 
                t:'s', n, o, r, 
                c: Math.random().toString(36).substr(2,3).toUpperCase(),
                d: new Date().toLocaleDateString('en-GB', { day:'2-digit', month:'long', year:'numeric' }),
                s: hexHD 
            };
            
            const jsonStr = JSON.stringify(data);
            const encoded = btoa(unescape(encodeURIComponent(jsonStr)));
            
            const currentURL = window.location.href.split('?')[0];
            renderQR(`${currentURL}?v=${encoded}`);
        }

        function generateBasicQR(type) {
            let val = "";
            if (type === 'url') val = document.getElementById('url-input').value;
            else if (type === 'vcard') val = `BEGIN:VCARD\nVERSION:3.0\nFN:${document.getElementById('vc-fn').value} ${document.getElementById('vc-ln').value}\nTEL:${document.getElementById('vc-tel').value}\nEND:VCARD`;
            else if (type === 'maps') val = document.getElementById('map-url').value;
            else if (type === 'wa') val = `https://wa.me/${document.getElementById('wa-num').value}?text=${encodeURIComponent(document.getElementById('wa-msg').value)}`;
            else if (type === 'file') val = document.getElementById('file-url').value;

            if (!val || val.length < 5) return alertCustom('Insufficient input data!');
            renderQR(val);
        }

        function renderQR(text) {
            const qrTarget = document.getElementById('qrcode');
            qrTarget.innerHTML = "";
            
            try {
                // CorrectLevel L allows maximum scannable data capacity
                new QRCode(qrTarget, { 
                    text: text, 
                    width: 512, 
                    height: 512, 
                    correctLevel: QRCode.CorrectLevel.L 
                });

                document.getElementById('preview-empty').classList.add('hidden');
                document.getElementById('preview-result').classList.remove('hidden');

                setTimeout(() => {
                    const img = qrTarget.querySelector('img');
                    if (!img) return;
                    const c = document.getElementById('final-qr-canvas'); c.width = 512; c.height = 512;
                    const cx = c.getContext('2d'); cx.fillStyle = "white"; cx.fillRect(0,0,512,512);
                    cx.drawImage(img, 0, 0, 512, 512);

                    if (uploadedLogoData) {
                        const l = new Image();
                        l.onload = () => {
                            const s = 100; cx.fillStyle = "white"; cx.fillRect(206, 206, 100, 100);
                            cx.drawImage(l, 211, 211, 90, 90);
                        };
                        l.src = uploadedLogoData;
                    }
                }, 400);
            } catch (e) {
                console.error("QR Generation failed", e);
                alertCustom("Payload exceeds scannable limit. Please shorten inputs.");
            }
        }

        function downloadFinalQR() {
            const link = document.createElement('a');
            link.download = `DEWAQR_AUTH_${Date.now()}.png`;
            link.href = document.getElementById('final-qr-canvas').toDataURL('image/png');
            link.click();
        }

        function checkURL() {
            const p = new URLSearchParams(window.location.search).get('v');
            if (p) {
                try {
                    const d = JSON.parse(decodeURIComponent(escape(atob(p))));
                    if (d.t === 's') {
                        document.getElementById('main-nav').style.display = 'none'; 
                        document.getElementById('main-app').style.display = 'none';
                        document.getElementById('verification-page').style.display = 'flex';
                        document.getElementById('v-name').textContent = d.n;
                        document.getElementById('v-org').textContent = d.o;
                        document.getElementById('v-role').textContent = d.r;
                        document.getElementById('v-code').textContent = '#' + d.c;
                        document.getElementById('v-date').textContent = d.d;
                        // Reconstruction at 100x50 for optimized clarity
                        document.getElementById('v-sig-img').src = hdBytemapToImage(d.s, 100, 50);
                        document.title = "Identity Verified: " + d.n;
                    }
                } catch(e) { console.error("Integrity check failure", e); }
            }
        }

        function alertCustom(m) {
            const a = document.createElement('div');
            a.className = "fixed top-24 left-1/2 -translate-x-1/2 bg-amber-500 text-slate-950 px-8 py-4 z-[100] text-[11px] font-black uppercase tracking-[0.2em] shadow-2xl standard-rounded text-center animate-bounce border-2 border-white/20";
            a.textContent = "⚠ " + m; document.body.appendChild(a);
            setTimeout(() => a.remove(), 3000);
        }
    </script>
</body>
</html>
